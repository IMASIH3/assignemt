<style>
.navbar {
  list-style-type: none;
  margin: 0;
  padding: 0;
  background-color: #f8f9fa;
}

.navbar li {
  display: inline-block;
}

.navbar a {
  display: block;
  padding: 10px 15px;
  text-decoration: none;
  color: #333;
}

.navbar a:hover {
  background-color: #F8F9FA;
}

.dropdown .dropdown-toggle::after {
  content: '\25BE';
  margin-left: 5px;
}

.dropdown-menu {
  display: none;
  position: absolute;
  background-color: #fff;
  padding: 10px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
}

.dropdown-menu.show {
  display: block;
}

</style>


<nav>
  <ul class="navbar">
    <li><a href="/parcels">Home</a></li>
    <li><a href="/search">Search Orders</a></li>
    <li><a href="/parcels">Parcels</a></li>
    <li><a href="/userlist">Manage Users</a></li>
    <% if current_user && current_user.is_admin? %>
      <li><a href="/service_types">Service Types</a></li>
      <li><%= link_to "Reports", csv_files_path %></li>
    <% end %>
  <li class="dropdown">
    <a class="dropdown-toggle" href="#" role="button" id="profileDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      Profile
    </a>
    <ul class="dropdown-menu" aria-labelledby="profileDropdown">
      <li>
        <% if current_user %>
          <div class="field">
            <strong>Name:</strong> <%= current_user.name %>
          </div>
          <div class="field">
            <strong>Email:</strong> <%= current_user.email %>
          </div>
          <div class="field">
            <strong>Mobile Number:</strong> <%= current_user.address&.mobile_number %>
          </div>
          <div class="field">
            <%= button_to "Sign out", destroy_user_session_path, method: :delete %>
          </div>
        <% else %>
          <div class="field">
            <%= link_to 'Sign in', new_user_session_path %>
          </div>
        <% end %>
      </li>
    </ul>
  </li>
  </ul>
</nav>

<script>


document.addEventListener("DOMContentLoaded", function() {
  // Attach the event listener to a parent element that exists on page load
  document.addEventListener("click", function(event) {
    const dropdownToggle = event.target.closest(".dropdown-toggle");
    const dropdownMenu = event.target.closest(".dropdown").querySelector(".dropdown-menu");

    if (dropdownToggle && dropdownMenu) {
      event.preventDefault();
      dropdownMenu.classList.toggle("show");
    } else {
      // Close the dropdown when clicking outside
      const dropdownMenus = document.querySelectorAll(".dropdown-menu");
      dropdownMenus.forEach(function(menu) {
        if (!menu.contains(event.target)) {
          menu.classList.remove("show");
        }
      });
    }
  });
});

</script>